/* eslint-disable unicorn/no-process-exit */
'use strict';
let updateNotifier = require('.');

const options = JSON.parse(process.argv[2]);

updateNotifier = new updateNotifier.UpdateNotifier(options);

<<<<<<< HEAD
updateNotifier.checkNpm().then(update => {
=======
(async () => {
	// Exit process when offline
	setTimeout(process.exit, 1000 * 30);

	const update = await updateNotifier.fetchInfo();

>>>>>>> b5d44e6a60317e635f4f681c85b4613284bcf75f
	// Only update the last update check time on success
	updateNotifier.config.set('lastUpdateCheck', Date.now());

	if (update.type && update.type !== 'latest') {
		updateNotifier.config.set('update', update);
	}

<<<<<<< HEAD
	// Call process exit explicitly to terminate the child process
	// Otherwise the child process will run forever, according to the Node.js docs
	process.exit();
}).catch(() => {
=======
	// Call process exit explicitly to terminate the child process,
	// otherwise the child process will run forever, according to the Node.js docs
	process.exit();
})().catch(error => {
	console.error(error);
>>>>>>> b5d44e6a60317e635f4f681c85b4613284bcf75f
	process.exit(1);
});
